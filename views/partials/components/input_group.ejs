<!--
    group: { id, input },
    input: { id, type, req, min, max },
    label: { id, content },
    validation: { regex, error_message }
-->

<div id="<%= group.id %>" class="input_group flexColumn vp">
    <div id="<%= group.input %>" class="in flexRow">
        <input
            type="<%= input.type %>"
            id="<%= input.id %>"
            name="<%= input.id %>"
            placeholder=" "
            class=""
            <%= input.req ? 'required' : '' %>
        />
        <label
            for="<%= input.id %>"
            id="<%= label.id %>"
            class="vp hp"
        >
            <%= label.content %>
        </label>
        <i class="fas hidden"></i>
    </div>
    <p class="hidden hp vp"><%= validation.error_message %></p>
</div>

<script type="module">
    import { updateInputState } from '/js/utils.js';

    ((d) => {
        const group=d.getElementById('<%= group.id %>');
        const input=group.querySelector('#<%= input.id %>');
        const label=group.querySelector('#<%= label.id %>');
        const icon=group.querySelector('i');
        const p=group.querySelector('p');

        // Inicializa el estado global si no existe        
        if(!window.inputStates) window.inputStates = {};
        inputStates[input.id] = { state: false, label, input, icon, p };

        const regEx = {
            regex: <%= validation.regex %>,
            error_message: '<%= validation.error_message %>'
        };
        input.addEventListener('input', () => {
            updateInputState(inputStates[input.id], regEx);
        });
    })(document);
</script>